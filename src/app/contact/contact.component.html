<div class="contact-container" role="main" aria-label="Page de contact d'Abdellah Aazdag">
  <div class="aurora-background" aria-hidden="true"></div>
  <div class="floating-particles" #particles aria-hidden="true"></div>

  <section class="glass-card" #glassCard>
    <div class="contact-header">
      <h1>Me <span class="highlight">Contacter</span></h1>
      <p class="subtitle">Une question, une opportunité ou simplement envie d'échanger ? N'hésitez pas à m'envoyer un message.</p>
    </div>

    @if (showErrorMessage) {
      <div class="error-message">
        <fa-icon [icon]="faCircleExclamation"></fa-icon>
        <p>{{ errorMessage }}</p>
        <button (click)="showErrorMessage = false" class="close-btn">
          <fa-icon [icon]="faTimes"></fa-icon>
        </button>
      </div>
    }

    <div class="contact-wrapper">
      <div class="contact-form-container">
        <form #contactForm="ngForm">
          <div class="form-group">
            <label for="name">
              <fa-icon [icon]="faUser"></fa-icon> Nom complet <span class="required">*</span>
            </label>
            <input 
              type="text" 
              id="name" 
              name="name" 
              [(ngModel)]="formData.name" 
              #nameModel="ngModel"
              (blur)="validateField('name', formData.name, nameModel)"
              required>
            @if (fieldErrors['name']) {
              <span class="error-text"><fa-icon [icon]="faCircleExclamation"></fa-icon> {{ fieldErrors['name'] }}</span>
            }
          </div>

          <div class="form-group">
            <label for="email">
              <fa-icon [icon]="faEnvelope"></fa-icon> Email <span class="required">*</span>
            </label>
            <input 
              type="email" 
              id="email" 
              name="email" 
              [(ngModel)]="formData.email" 
              #emailModel="ngModel"
              (blur)="validateField('email', formData.email, emailModel)"
              required email>
            @if (fieldErrors['email']) {
              <span class="error-text"><fa-icon [icon]="faCircleExclamation"></fa-icon> {{ fieldErrors['email'] }}</span>
            }
          </div>

          <div class="form-group">
            <label for="subject">
              <fa-icon [icon]="faTag"></fa-icon> Sujet <span class="required">*</span>
            </label>
            <input 
              type="text" 
              id="subject" 
              name="subject" 
              [(ngModel)]="formData.subject"
              #subjectModel="ngModel"
              (blur)="validateField('subject', formData.subject, subjectModel)" 
              required>
            @if (fieldErrors['subject']) {
              <span class="error-text"><fa-icon [icon]="faCircleExclamation"></fa-icon> {{ fieldErrors['subject'] }}</span>
            }
          </div>

          <div class="form-group">
            <label for="message">
              <fa-icon [icon]="faCommentAlt"></fa-icon> Message <span class="required">*</span>
            </label>
            <textarea 
              id="message" 
              name="message" 
              rows="5" 
              [(ngModel)]="formData.message"
              #messageModel="ngModel"
              (blur)="validateField('message', formData.message, messageModel)" 
              required>
            </textarea>
            @if (fieldErrors['message']) {
              <span class="error-text"><fa-icon [icon]="faCircleExclamation"></fa-icon> {{ fieldErrors['message'] }}</span>
            }
          </div>

          <button type="button" class="submit-btn" (click)="confirmSend(contactForm)" [disabled]="isSubmitting || !contactForm.valid">
            @if (isSubmitting) {
              <fa-icon [icon]="faSpinner" spin></fa-icon> Envoi...
            } @else {
              <fa-icon [icon]="faPaperPlane"></fa-icon> Envoyer le message
            }
          </button>
        </form>
      </div>

      <div class="contact-info">
        <h3>Informations</h3>
        <p><fa-icon [icon]="faEnvelope"></fa-icon> abdellah.aazdag.23&#64;ump.ac.ma</p>
        <p><fa-icon [icon]="faPhone"></fa-icon> +212 699-330304</p>
        <div class="social-links">
          <a href="https://github.com/aazdagabde" target="_blank" aria-label="GitHub">
            <fa-icon [icon]="faGithub"></fa-icon>
          </a>
          <a href="https://linkedin.com/in/aazdag-abdellah" target="_blank" aria-label="LinkedIn">
            <fa-icon [icon]="faLinkedinIn"></fa-icon>
          </a>
        </div>
      </div>
    </div>
  </section>

  @if (showConfirmationModal) {
    <div class="confirmation-modal-overlay">
      <div class="confirmation-modal">
        <h3><fa-icon [icon]="faPaperPlane"></fa-icon> Confirmer l'envoi</h3>
        <p>Êtes-vous sûr de vouloir envoyer ce message ?</p>
        <div class="modal-actions">
          <button (click)="closeConfirmationModal()" class="cancel-btn">
            <fa-icon [icon]="faTimes"></fa-icon> Annuler
          </button>
          <button (click)="onSubmit(contactForm)" class="confirm-btn">
            <fa-icon [icon]="faPaperPlane"></fa-icon> Confirmer
          </button>
        </div>
      </div>
    </div>
  }

  @if (showSuccessMessage) {
    <div class="success-message">
      <fa-icon [icon]="faCheckCircle"></fa-icon>
      <p>Message envoyé avec succès ! Merci.</p>
    </div>
  }
</div>